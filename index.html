<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Covid-19</title>
    <style>
      canvas {
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas"></canvas>
    <script src="chartjs/Chart.min.js"></script>
    <script>
      var portugal = [
        ["3/10/20", 41],
        ["3/11/20", 59],
        ["3/12/20", 59],
        ["3/13/20", 112],
        ["3/14/20", 169],
        ["3/15/20", 245],
        ["3/2/20", 2],
        ["3/3/20", 2],
        ["3/4/20", 5],
        ["3/5/20", 8],
        ["3/6/20", 13],
        ["3/7/20", 20],
        ["3/8/20", 30],
        ["3/9/20", 30]
      ];

      var australia = [
        ["1/22/20", 0],
        ["1/23/20", 0],
        ["1/24/20", 0],
        ["1/25/20", 0],
        ["1/26/20", 4],
        ["1/27/20", 5],
        ["1/28/20", 5],
        ["1/29/20", 6],
        ["1/30/20", 9],
        ["1/31/20", 9],
        ["2/1/20", 12],
        ["2/10/20", 15],
        ["2/11/20", 15],
        ["2/12/20", 15],
        ["2/13/20", 15],
        ["2/14/20", 15],
        ["2/15/20", 15],
        ["2/16/20", 15],
        ["2/17/20", 15],
        ["2/18/20", 15],
        ["2/19/20", 15],
        ["2/2/20", 12],
        ["2/20/20", 15],
        ["2/21/20", 19],
        ["2/22/20", 22],
        ["2/23/20", 22],
        ["2/24/20", 22],
        ["2/25/20", 22],
        ["2/26/20", 22],
        ["2/27/20", 23],
        ["2/28/20", 23],
        ["2/29/20", 25],
        ["2/3/20", 12],
        ["2/4/20", 13],
        ["2/5/20", 13],
        ["2/6/20", 14],
        ["2/7/20", 15],
        ["2/8/20", 15],
        ["2/9/20", 15],
        ["3/1/20", 27],
        ["3/10/20", 107],
        ["3/11/20", 128],
        ["3/12/20", 128],
        ["3/13/20", 200],
        ["3/14/20", 250],
        ["3/15/20", 297],
        ["3/2/20", 30],
        ["3/3/20", 39],
        ["3/4/20", 52],
        ["3/5/20", 55],
        ["3/6/20", 60],
        ["3/7/20", 63],
        ["3/8/20", 76],
        ["3/9/20", 91]
      ];

      const italia = [
        ["1/31/20", 2],
        ["2/1/20", 2],
        ["2/10/20", 3],
        ["2/11/20", 3],
        ["2/12/20", 3],
        ["2/13/20", 3],
        ["2/14/20", 3],
        ["2/15/20", 3],
        ["2/16/20", 3],
        ["2/17/20", 3],
        ["2/18/20", 3],
        ["2/19/20", 3],
        ["2/2/20", 2],
        ["2/20/20", 3],
        ["2/21/20", 20],
        ["2/22/20", 62],
        ["2/23/20", 155],
        ["2/24/20", 229],
        ["2/25/20", 322],
        ["2/26/20", 453],
        ["2/27/20", 655],
        ["2/28/20", 888],
        ["2/29/20", 1128],
        ["2/3/20", 2],
        ["2/4/20", 2],
        ["2/5/20", 2],
        ["2/6/20", 2],
        ["2/7/20", 3],
        ["2/8/20", 3],
        ["2/9/20", 3],
        ["3/1/20", 1694],
        ["3/10/20", 10149],
        ["3/11/20", 12462],
        ["3/12/20", 12462],
        ["3/13/20", 17660],
        ["3/14/20", 21157],
        ["3/15/20", 24747],
        ["3/2/20", 2036],
        ["3/3/20", 2502],
        ["3/4/20", 3089],
        ["3/5/20", 3858],
        ["3/6/20", 4636],
        ["3/7/20", 5883],
        ["3/8/20", 7375],
        ["3/9/20", 9172]
      ];

      const austria = [
        ["2/25/20", 2],
        ["2/26/20", 2],
        ["2/27/20", 3],
        ["2/28/20", 3],
        ["2/29/20", 9],
        ["3/1/20", 14],
        ["3/10/20", 182],
        ["3/11/20", 246],
        ["3/12/20", 302],
        ["3/13/20", 504],
        ["3/14/20", 655],
        ["3/15/20", 860],
        ["3/2/20", 18],
        ["3/3/20", 21],
        ["3/4/20", 29],
        ["3/5/20", 41],
        ["3/6/20", 55],
        ["3/7/20", 79],
        ["3/8/20", 104],
        ["3/9/20", 131]
      ];

      var labelsMap = {};
      portugal.forEach(item => {
        labelsMap[item[0]] = [item[0], 0, 0, 0, 0];
      });
      australia.forEach(item => {
        labelsMap[item[0]] = [item[0], 0, 0, 0, 0];
      });
      italia.forEach(item => {
        labelsMap[item[0]] = [item[0], 0, 0, 0, 0];
      });
      austria.forEach(item => {
        labelsMap[item[0]] = [item[0], 0, 0, 0, 0];
      });

      portugal.forEach(item => {
        labelsMap[item[0]][1] = item[1];
      });
      australia.forEach(item => {
        labelsMap[item[0]][2] = item[1];
      });
      italia.forEach(item => {
        labelsMap[item[0]][3] = item[1];
      });
      austria.forEach(item => {
        labelsMap[item[0]][4] = item[1];
      });

      const data = Object.values(labelsMap).sort(function(lhs, rhs) {
        const lhsDates = lhs[0].split("/").map(value => parseInt(value));
        const lhsMonth = lhsDates[0];
        const lhsDay = lhsDates[1];
        const lhsYear = lhsDates[2];
        const rhsDates = rhs[0].split("/").map(value => parseInt(value));
        const rhsMonth = rhsDates[0];
        const rhsDay = rhsDates[1];
        const rhsYear = rhsDates[2];

        if (lhsYear > rhsYear) {
          return 1;
        } else if (lhsYear < rhsYear) {
          return -1;
        } else if (lhsMonth > rhsMonth) {
          return 1;
        } else if (lhsMonth < rhsMonth) {
          return -1;
        } else if (lhsDay > rhsDay) {
          return 1;
        } else if (lhsDay < rhsDay) {
          return -1;
        } else {
          return 0;
        }
      });

      var config = {
        type: "line",
        data: {
          labels: data.map(item => item[0]),
          datasets: [
            {
              label: "Portugal",
              backgroundColor: "#36a2eb",
              borderColor: "#36a2eb",
              data: data.map(item => item[1]),
              fill: false
            },
            {
              label: "Australia",
              backgroundColor: "#ff6384",
              borderColor: "#ff6384",
              data: data.map(item => item[2]),
              fill: false
            },
            {
              label: "Italia",
              backgroundColor: "#ffcd56",
              borderColor: "#ffcd56",
              data: data.map(item => item[3]),
              fill: false
            },
            {
              label: "Austria",
              backgroundColor: "#26b578",
              borderColor: "#26b578",
              data: data.map(item => item[4]),
              fill: false
            }
          ]
        },
        options: {
          responsive: true,
          title: {
            display: true,
            text: "Covid-19 contagion rate"
          },
          tooltips: {
            mode: "index",
            intersect: false
          },
          hover: {
            mode: "nearest",
            intersect: true
          },
          scales: {
            x: {
              display: true,
              scaleLabel: {
                display: true,
                labelString: "Date"
              }
            },
            y: {
              display: true,
              scaleLabel: {
                display: true,
                labelString: "Confirmed Cases"
              }
            }
          }
        }
      };

      window.onload = function() {
        var ctx = document.getElementById("canvas").getContext("2d");
        window.myLine = new Chart(ctx, config);
      };
    </script>
  </body>
</html>
